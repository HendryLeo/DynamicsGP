<Component Name="GL_Transaction_Entry" ProductId="9001" Object="Form" >
= Form	"GL_Transaction_Entry"
{
	Datatypes
	{
		Datatype	"CustomerID_Lookup"		
		{
			Control	"PushButton"
			DefaultDown	"00000"
			DefaultMouseOver	"00000"
			DefaultUp	"00000"
			Prompt	"Customer"
			PromptDown	""
			PromptMouseOver	""
			StaticType	"Picture"
			~ItemImages
			{
			}
		}
		Datatype	"VendorID_Lookup"		
		{
			Control	"PushButton"
			DefaultDown	"00000"
			DefaultMouseOver	"00000"
			DefaultUp	"00000"
			Prompt	"Vendor"
			PromptDown	""
			PromptMouseOver	""
			StaticType	"Picture"
			~ItemImages
			{
			}
		}
		Datatype	"strCustomerID"		
		{
			AllowOddLength	"false"
			Control	"String"
			Format	""
			KeyableLength	"15"
			StorageLength	"32"
		}
		Datatype	"strCustomerName"		
		{
			AllowOddLength	"false"
			Control	"String"
			Format	""
			KeyableLength	"64"
			StorageLength	"66"
		}
		Datatype	"strVendorID"		
		{
			AllowOddLength	"false"
			Control	"String"
			Format	""
			KeyableLength	"15"
			StorageLength	"32"
		}
		Datatype	"strVendorName"		
		{
			AllowOddLength	"false"
			Control	"String"
			Format	""
			KeyableLength	"64"
			StorageLength	"66"
		}
	}
	Fields
	{
		Field	"CustomerID_Lookup"		
		{
			ArraySize	"0"
			Datatype	"(L) CustomerID_Lookup"
			LookupForm	""
			PhysicalName	""
		}
		Field	"VendorID_Lookup"		
		{
			ArraySize	"0"
			Datatype	"(L) VendorID_Lookup"
			LookupForm	""
			PhysicalName	""
		}
		Field	"strCustomerID"		
		{
			ArraySize	"0"
			Datatype	"(L) strCustomerID"
			LookupForm	""
			PhysicalName	""
		}
		Field	"strCustomerName"		
		{
			ArraySize	"0"
			Datatype	"(L) strCustomerName"
			LookupForm	""
			PhysicalName	""
		}
		Field	"strVendorID"		
		{
			ArraySize	"0"
			Datatype	"(L) strVendorID"
			LookupForm	""
			PhysicalName	""
		}
		Field	"strVendorName"		
		{
			ArraySize	"0"
			Datatype	"(L) strVendorName"
			LookupForm	""
			PhysicalName	""
		}
	}
	Windows
	{
		= Window	"DateEntry"
		{
			LastTag	"10000"
		}
		= Window	"GL_Transaction_Entry"
		{
			Fields
			{
				= WindowControl	"(L) AccountIsFocused"
				{
					PositionTop	"527"
				}
				= WindowControl	"(L) Already Displayed"
				{
					PositionTop	"544"
				}
				= WindowControl	"(L) Browse Batch"
				{
					PositionTop	"561"
				}
				= WindowControl	"(L) Browse Journal"
				{
					PositionTop	"578"
				}
				WindowControl	"(L) CustomerID_Lookup"				
				{
					Alignment	"center"
					Appearance	"2D Border"
					BackColor	"System - Button Face"
					Border	"true"
					ButtonStyle	"TextOnly"
					Cancel	"false"
					ControlType	"PushButton"
					Default	"false"
					Editable	"true"
					EndTransaction	"false"
					Field	"(L) CustomerID_Lookup"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					HyperSpace	"false"
					LinkedLookup	"0"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"Black"
					PositionLeft	"311"
					PositionTop	"205"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"50"
					TabStop	"true"
					Tag	"10014"
					Tooltip	"Customer Lookup"
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"232"
					Zoom	"false"
				}
				= WindowControl	"(L) Date Changed"
				{
					PositionTop	"595"
				}
				= WindowControl	"(L) Date Verified"
				{
					PositionTop	"612"
				}
				= WindowControl	"(L) Dummy Batch"
				{
					PositionTop	"629"
				}
				= WindowControl	"(L) EmptyTotalCredits"
				{
					PositionTop	"424"
				}
				= WindowControl	"(L) EmptyTotalDebits"
				{
					PositionTop	"424"
				}
				= WindowControl	"(L) EmptyTotalDifference"
				{
					PositionTop	"443"
				}
				= WindowControl	"(L) EnableNegative"
				{
					PositionTop	"646"
				}
				= WindowControl	"(L) EnableTaxDate"
				{
					PositionTop	"663"
				}
				= WindowControl	"(L) ExchangeRateChanged"
				{
					PositionTop	"697"
				}
				= WindowControl	"(L) F-Difference"
				{
					PositionTop	"443"
				}
				= WindowControl	"(L) From View Flip"
				{
					PositionTop	"731"
				}
				= WindowControl	"(L) Get Next Journal Entry"
				{
					PositionTop	"748"
				}
				= WindowControl	"(L) Journal Entry Validated"
				{
					PositionTop	"765"
				}
				= WindowControl	"(L) Line Inserted"
				{
					PositionTop	"527"
				}
				= WindowControl	"(L) LoadCorrectingTrx"
				{
					PositionTop	"803"
				}
				= WindowControl	"(L) MDA Exists"
				{
					PositionTop	"544"
				}
				= WindowControl	"(L) New Record"
				{
					PositionTop	"629"
				}
				= WindowControl	"(L) NewCurrency"
				{
					PositionTop	"595"
				}
				= WindowControl	"(L) NewDate"
				{
					PositionTop	"612"
				}
				= WindowControl	"(L) Next Journal Entry"
				{
					PositionTop	"561"
				}
				= WindowControl	"(L) Next Sequence DLR"
				{
					PositionTop	"578"
				}
				= WindowControl	"(L) Note Index[1]"
				{
					PositionTop	"646"
				}
				= WindowControl	"(L) O-Difference"
				{
					PositionTop	"443"
				}
				= WindowControl	"(L) Old TRX Total"
				{
					PositionTop	"680"
				}
				= WindowControl	"(L) Old Trx Date"
				{
					PositionTop	"663"
				}
				= WindowControl	"(L) OrigHdrSeqLine"
				{
					PositionTop	"805"
				}
				= WindowControl	"(L) OrigOriginatingTrxSrc"
				{
					PositionTop	"863"
				}
				= WindowControl	"(L) OrigRevDate"
				{
					PositionTop	"844"
				}
				= WindowControl	"(L) OrigSeries"
				{
					PositionTop	"882"
				}
				= WindowControl	"(L) OrigTrxDate"
				{
					PositionTop	"825"
				}
				= WindowControl	"(L) Override Exchange Info"
				{
					PositionTop	"714"
				}
				= WindowControl	"(L) Posted Real Time TRX"
				{
					PositionTop	"731"
				}
				= WindowControl	"(L) Posting To History"
				{
					PositionTop	"697"
				}
				= WindowControl	"(L) Prev Currency"
				{
					PositionTop	"748"
				}
				= WindowControl	"(L) Prev Currency Index"
				{
					PositionTop	"765"
				}
				= WindowControl	"(L) Prev Decimal Places"
				{
					PositionTop	"527"
				}
				= WindowControl	"(L) Prev Rate Calc Method"
				{
					PositionTop	"544"
				}
				= WindowControl	"(L) Prev Rate Type ID"
				{
					PositionTop	"561"
				}
				= WindowControl	"(L) Prev Time"
				{
					PositionTop	"578"
				}
				= WindowControl	"(L) Prev X Date"
				{
					PositionTop	"595"
				}
				= WindowControl	"(L) Prev X Rate"
				{
					PositionTop	"612"
				}
				= WindowControl	"(L) Prev X Table ID"
				{
					PositionTop	"629"
				}
				= WindowControl	"(L) Returned Currency"
				{
					PositionTop	"646"
				}
				= WindowControl	"(L) Reversing Date Verified"
				{
					PositionTop	"663"
				}
				= WindowControl	"(L) StartingSequenceLine"
				{
					PositionTop	"680"
				}
				= WindowControl	"(L) Status"
				{
					PositionTop	"477"
				}
				= WindowControl	"(L) SuppressViewFlip"
				{
					PositionTop	"697"
				}
				= WindowControl	"(L) Total F-Credits"
				{
					PositionTop	"424"
				}
				= WindowControl	"(L) Total F-Debits"
				{
					PositionTop	"424"
				}
				= WindowControl	"(L) Total O-Credits"
				{
					PositionTop	"424"
				}
				= WindowControl	"(L) Total O-Debits"
				{
					PositionTop	"424"
				}
				= WindowControl	"(L) VAT Account Number"
				{
					PositionTop	"714"
				}
				= WindowControl	"(L) VAT Button"
				{
					PositionTop	"442"
				}
				= WindowControl	"(L) VAT Tax Detail ID"
				{
					PositionTop	"731"
				}
				WindowControl	"(L) VendorID_Lookup"				
				{
					Alignment	"center"
					Appearance	"2D Border"
					BackColor	"System - Button Face"
					Border	"true"
					ButtonStyle	"TextOnly"
					Cancel	"false"
					ControlType	"PushButton"
					Default	"false"
					Editable	"true"
					EndTransaction	"false"
					Field	"(L) VendorID_Lookup"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					HyperSpace	"false"
					LinkedLookup	"10005"
					LinkedPrompt	"0"
					Pattern	"(none)"
					PatternColor	"Black"
					PositionLeft	"263"
					PositionTop	"205"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"50"
					TabStop	"true"
					Tag	"10008"
					Tooltip	"Vendor Lookup"
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"231"
					Zoom	"false"
				}
				= WindowControl	"(L) Warning_Called"
				{
					PositionTop	"784"
				}
				= WindowControl	"(L) fDidPreFormFinish"
				{
					PositionTop	"714"
				}
				WindowControl	"(L) strVendorID"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					AutoComplete	"false"
					AutoCopy	"false"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"String"
					DisableLookup	"false"
					Editable	"false"
					Field	"(L) strVendorID"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"10003"
					Password	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"144"
					PositionTop	"205"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"120"
					TabStop	"true"
					Tag	"10005"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"229"
					Zoom	"false"
				}
				WindowControl	"(L) strVendorName"				
				{
					Alignment	"left"
					Appearance	"2D Border"
					AutoComplete	"false"
					AutoCopy	"false"
					BackColor	"System - Window Background"
					Border	"true"
					ControlType	"String"
					DisableLookup	"false"
					Editable	"false"
					Field	"(L) strVendorName"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Window Text"
					FontItalic	"false"
					FontUnderline	"false"
					LinkedFormat	"0"
					LinkedLookup	"0"
					LinkedPrompt	"10004"
					Password	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"144"
					PositionTop	"224"
					ReadingOrder	"LeftToRight"
					Required	"false"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SavedOnRestart	"false"
					SetChangeFlag	"true"
					SizeHeight	"20"
					SizeWidth	"222"
					TabStop	"true"
					Tag	"10006"
					Tooltip	""
					UseUniqueHelp	"true"
					Visible	"true"
					ZOrder	"230"
					Zoom	"false"
				}
				= ScrollingWindow	"0033-Transaction_Scroll"
				{
					LastTag	"10000"
					PositionTop	"309"
				}
				WindowPrompt	"10015"				
				{
					Alignment	"left"
					Appearance	"3D Highlight"
					BackColor	"System - Button Face"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"8"
					PositionTop	"205"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"137"
					Text	"Vendor/Customer ID"
					Visible	"true"
					ZOrder	"233"
					Zoom	"false"
				}
				WindowPrompt	"10016"				
				{
					Alignment	"left"
					Appearance	"3D Highlight"
					BackColor	"System - Button Face"
					Border	"true"
					Font	"System (generic)"
					FontBold	"false"
					FontColor	"System - Button Text"
					FontItalic	"false"
					FontUnderline	"false"
					Pattern	"(none)"
					PatternColor	"White"
					PositionLeft	"8"
					PositionTop	"224"
					ReadingOrder	"LeftToRight"
					ResizeHoriz	"StayLeft"
					ResizeVert	"StayTop"
					SizeHeight	"20"
					SizeWidth	"137"
					Text	"Vendor/Customer Name"
					Visible	"true"
					ZOrder	"234"
					Zoom	"false"
				}
				= WindowLine	"150"
				{
					PositionTop	"252"
				}
				= WindowPrompt	"205"
				{
					PositionTop	"252"
				}
				= WindowPrompt	"206"
				{
					PositionTop	"424"
				}
				= WindowPrompt	"207"
				{
					PositionTop	"252"
				}
				= WindowPrompt	"208"
				{
					PositionTop	"252"
				}
				= WindowLine	"221"
				{
					PositionTop	"271"
				}
				= WindowPrompt	"222"
				{
					PositionTop	"271"
				}
				= WindowLine	"295"
				{
					PositionTop	"290"
				}
				= WindowPrompt	"308"
				{
					PositionTop	"290"
				}
				= WindowPrompt	"470"
				{
					PositionTop	"477"
				}
				= WindowPrompt	"479"
				{
					PositionTop	"252"
				}
				= WindowPrompt	"542"
				{
					PositionTop	"271"
				}
				= WindowLine	"564"
				{
					PositionTop	"290"
				}
				= WindowPrompt	"566"
				{
					PositionTop	"290"
				}
				= WindowLine	"575"
				{
					PositionTop	"469"
				}
				= WindowPrompt	"98"
				{
					PositionTop	"443"
				}
				= WindowShape	"99"
				{
					PositionTop	"252"
				}
				= WindowControl	"AA Button"
				{
					PositionTop	"252"
				}
				= WindowControl	"Added Rate"
				{
					PositionTop	"527"
				}
				= WindowControl	"Array of Audit Trails[1]"
				{
					PositionTop	"544"
				}
				= WindowControl	"Array of Audit Trails[2]"
				{
					PositionTop	"561"
				}
				= WindowControl	"Array of Audit Trails[3]"
				{
					PositionTop	"578"
				}
				= WindowControl	"Array of Audit Trails[4]"
				{
					PositionTop	"595"
				}
				= WindowControl	"Batch Source"
				{
					PositionTop	"612"
				}
				= WindowControl	"BrowseBox"
				{
					PositionTop	"477"
				}
				= WindowControl	"Changed"
				{
					PositionTop	"629"
				}
				= WindowControl	"Closed Year"
				{
					PositionTop	"646"
				}
				= WindowControl	"Correcting Trx Type"
				{
					PositionTop	"729"
				}
				= WindowControl	"Currency Index"
				{
					PositionTop	"663"
				}
				= WindowControl	"Currency View"
				{
					PositionTop	"680"
				}
				= WindowControl	"Currency View Button Reference"
				{
					PositionTop	"697"
				}
				= WindowControl	"CustomLinks Zoom Button[1]"
				{
					PositionTop	"271"
				}
				= WindowControl	"DTA Index"
				{
					PositionTop	"748"
				}
				= WindowControl	"Decimal Places Currency"
				{
					PositionTop	"714"
				}
				= WindowControl	"Denomination Exchange Rate"
				{
					PositionTop	"731"
				}
				= WindowControl	"End of File Button - Toolbar"
				{
					PositionTop	"478"
				}
				= WindowControl	"Exchange Date"
				{
					PositionTop	"561"
				}
				= WindowControl	"Exchange Rate"
				{
					PositionTop	"595"
				}
				= WindowControl	"Exchange Table ID"
				{
					PositionTop	"578"
				}
				= WindowControl	"Expansion Button 2"
				{
					PositionTop	"252"
				}
				= WindowControl	"Expansion Button 4"
				{
					PositionTop	"252"
				}
				= WindowControl	"Functional Currency Index"
				{
					PositionTop	"612"
				}
				= WindowControl	"GL Header Valid"
				{
					PositionTop	"629"
				}
				= WindowControl	"History TRX"
				{
					PositionTop	"646"
				}
				= WindowControl	"ICEREnabled"
				{
					PositionTop	"663"
				}
				= WindowControl	"Lookup Button 10"
				{
					PositionTop	"290"
				}
				= WindowControl	"Lookup Button 4"
				{
					PositionTop	"252"
				}
				= WindowControl	"Lookup Button 6"
				{
					PositionTop	"252"
				}
				= WindowControl	"Lookup Button 8"
				{
					PositionTop	"271"
				}
				= WindowControl	"MC Transaction State"
				{
					PositionTop	"680"
				}
				= WindowControl	"MDA Expansion Button"
				{
					PositionTop	"252"
				}
				= WindowControl	"Next Button - Toolbar"
				{
					PositionTop	"478"
				}
				= WindowControl	"Note Absent Button - Toolbar "
				{
					PositionTop	"474"
				}
				= WindowControl	"Note Index"
				{
					PositionTop	"697"
				}
				= WindowControl	"Note Present Button - Toolbar"
				{
					PositionTop	"474"
				}
				= WindowControl	"Open Year"
				{
					PositionTop	"714"
				}
				= WindowControl	"Origin"
				{
					PositionTop	"731"
				}
				= WindowControl	"Original JE"
				{
					PositionTop	"748"
				}
				= WindowControl	"Original JE Seq Num"
				{
					PositionTop	"786"
				}
				= WindowControl	"Original JE Year"
				{
					PositionTop	"767"
				}
				= WindowControl	"Originating TRX Source"
				{
					PositionTop	"748"
				}
				= WindowControl	"Period ID"
				{
					PositionTop	"527"
				}
				= WindowControl	"Posting Status"
				{
					PositionTop	"544"
				}
				= WindowControl	"Previous Button - Toolbar"
				{
					PositionTop	"478"
				}
				= WindowControl	"Rate Calculation Method"
				{
					PositionTop	"593"
				}
				= WindowControl	"Rate Type ID"
				{
					PositionTop	"578"
				}
				= WindowControl	"Reversing Closed Year"
				{
					PositionTop	"559"
				}
				= WindowControl	"Reversing History TRX"
				{
					PositionTop	"612"
				}
				= WindowControl	"Reversing Period ID"
				{
					PositionTop	"629"
				}
				= WindowControl	"Reversing Year"
				{
					PositionTop	"646"
				}
				= WindowControl	"Scroll Expand Switch"
				{
					PositionTop	"271"
				}
				= WindowControl	"Scroll Shrink Switch"
				{
					PositionTop	"252"
				}
				= WindowControl	"Scrolling Window Expand Button"
				{
					PositionTop	"252"
				}
				= WindowControl	"Scrolling Window Shrink"
				{
					PositionTop	"271"
				}
				= WindowControl	"Sort By"
				{
					PositionTop	"477"
				}
				= WindowControl	"Time"
				{
					PositionTop	"663"
				}
				= WindowControl	"Top of File Button - Toolbar"
				{
					PositionTop	"478"
				}
				= WindowControl	"View Changed To Originating"
				{
					PositionTop	"680"
				}
				= WindowControl	"View Menu Reference"
				{
					PositionTop	"697"
				}
				= WindowControl	"WindowHelp"
				{
					PositionTop	"474"
				}
				= WindowControl	"Zoom Button"
				{
					PositionTop	"252"
				}
				= WindowControl	"Zoom Buttons[1]"
				{
					PositionTop	"271"
				}
				= WindowControl	"dtaTrxCodesState"
				{
					PositionTop	"544"
				}
				= WindowControl	"dtaTrxGroupsState"
				{
					PositionTop	"527"
				}
			}
			LastTag	"10016"
			SizeHeight	"501"
		}
	}
}
</Component>
<Component Name="GL_Transaction_Entry" ProductId="9001" Object="VBAForm" >
VBAForm	"GL_Transaction_Entry"
{
	Windows
	{
		Window	"GL_Transaction_Entry"		
		{
			Code	"Public Deleting As Boolean
Public WanttoDelete As Boolean
Public OktoDelete As Boolean
Dim JEtoDelete As String
'Dim Opening As Boolean
Dim CN As New ADODB.Connection
Dim rst As New ADODB.Recordset
Dim cmd As New ADODB.Command

Private Sub Delete_AfterUserChanged()
Dim JE_Collection As DUOSObjects
Dim JE_Entry As DUOSObject
    
    
    If WanttoDelete And OktoDelete Then
        Set JE_Collection = DUOSObjectsGet(\"JE_Collection\")
        Set JE_Entry = JE_Collection.Item(JEtoDelete)
        
        JE_Collection.Remove (JEtoDelete)
        
    End If
    Deleting = False
End Sub

Private Sub Delete_BeforeUserChanged(KeepFocus As Boolean, CancelLogic As Boolean)
    Deleting = True
End Sub

Private Sub JournalEntry_AfterGotFocus()
    'If Opening Then Opening = False
End Sub

Private Sub JournalEntry_Changed()
Dim JE_Collection As DUOSObjects
Dim JE_Entry As DUOSObject
Dim JE As String

    'If Opening Then Exit Sub
    If Not JournalEntry.Empty And Not Deleting Then
        JEtoDelete = JournalEntry
        OktoDelete = True
        WanttoDelete = False
    End If
    Set JE_Collection = DUOSObjectsGet(\"JE_Collection\")
    
    If Not JournalEntry.Empty And Not Posting Then
        
        Set JE_Entry = JE_Collection.Item(JournalEntry)
        
        If JE_Entry.Properties(\"VendorID\") = \"\" Then
            
            JE = Replace(JournalEntry.Value, \",\", \"\")
            JE = Replace(JE, \".\", \"\")
            
            'build T-SQL statement for select and execute it to populate recordset object
            cmd.CommandText = \"SELECT ORMSTRID, ORMSTRNM FROM GL10001 WHERE(JRNENTRY=\" & JE & \")\"
            
            Set rst = cmd.Execute
            
            strVendorID = \"\"
            strVendorName = \"\"
            
            If rst.EOF Or rst.BOF Then
                Me.Changed = False
                Exit Sub
            End If
            'set field values from value in retrieved recordset
            strVendorName = Trim(rst!ORMSTRNM)
            strVendorID = Trim(rst!ORMSTRID)
        Else
            strVendorID = JE_Entry.Properties(\"VendorID\")
            strVendorName = JE_Entry.Properties(\"VendorName\")
        End If
        Me.Changed = False
        
    End If
    
End Sub

'Private Sub Lookup_BeforeUserChanged(KeepFocus As Boolean, CancelLogic As Boolean)
'    'Set the lookup window reference to the field we want to return back to
'    'Notice the keyword \\\"set\\\".  You must use that when you are setting an
'    'instance of an object
'    Set SmartList.Vendors.ReturnField = strVendorID
'    Set SmartList.Vendors.ReturnField2 = strVendorName
'    'Set SmartList.Vendors.returnfield2 = strVendorName
'    'open the lookup and set the hidden sortby field which will fill the window for us
'    SmartList.Vendors.Open
'    SmartList.Vendors.a.Caption = \"Vendor Name\"
'    SmartList.Vendors.a1.Caption = \"Vendor ID\"
'    SmartList.Vendors.a.Value = 1
'
'
'End Sub


Private Sub Post_BeforeUserChanged(KeepFocus As Boolean, CancelLogic As Boolean)
Dim CN As New ADODB.Connection
Dim rst As New ADODB.Recordset
Dim cmd As New ADODB.Command
Dim recAffected As Long
Dim JE_Collection As DUOSObjects
Dim JE_Entry As DUOSObject

    If strVendorID = \"\" Then
        If MsgBox(\"VendorID tidak diisi, Mau dilanjutkan?\", vbYesNo, \"Vendor tidak diisi\") = vbNo Then
            CancelLogic = True
            Exit Sub
        End If
    End If


    ' ADO Connection
    Set CN = UserInfoGet.CreateADOConnection
    'Use a client-side cursor so that a recordset count can be obtained later.
    CN.CursorLocation = 3
    'set the database to the currently logged in db
    CN.DefaultDatabase = UserInfoGet.IntercompanyID
    
    cmd.ActiveConnection = CN
    cmd.CommandType = adCmdText
    
    cmd.CommandText = \"UPDATE GL10001 SET ORMSTRID='\" & strVendorID & \"', ORMSTRNM='\" & strVendorName & \"' WHERE JRNENTRY=\" & Replace(JournalEntry, \",\", \"\")
    
    Set rst = cmd.Execute(recAffected)
    'MsgBox recAffected
    'Close the recordset and connection objects
    If rst.State = adStateOpen Then rst.Close
    If CN.State = adStateOpen Then CN.Close
    Set rst = Nothing
    Set CN = Nothing
    Set cmd = Nothing
    
        Set JE_Collection = DUOSObjectsGet(\"JE_Collection\")
        Set JE_Entry = JE_Collection.Item(JournalEntry)
        
        JE_Collection.Remove (JournalEntry)
        
    

    
End Sub

Private Sub Save_BeforeUserChanged(KeepFocus As Boolean, CancelLogic As Boolean)
Dim JE_Collection As DUOSObjects
Dim JE_Entry As DUOSObject

    If Me.Required And strVendorID <> \"\" And strVendorName <> \"\" Then 'all required fields are filled
        Set JE_Collection = DUOSObjectsGet(\"JE_Collection\")
        Set JE_Entry = JE_Collection.Item(JournalEntry)
        
        JE_Entry.Properties(\"VendorID\") = strVendorID
        JE_Entry.Properties(\"VendorName\") = strVendorName
    
        
    End If
End Sub

Private Sub Window_AfterClose()
    'Close the recordset and connection objects
    If rst.State = adStateOpen Then rst.Close
    If CN.State = adStateOpen Then CN.Close
    Set rst = Nothing
    Set CN = Nothing
    Set cmd = Nothing

End Sub

Private Sub Window_AfterModalDialog(ByVal DlgType As DialogType, PromptString As String, Control1String As String, Control2String As String, Control3String As String, Answer As DialogCtrl)
Dim JE_Collection As DUOSObjects
Dim JE_Entry As DUOSObject

    If PromptString = \"Do you want to save changes or delete this transaction?\" Then
        'The save dialog appeared, asking if the user wants to save changes
        If Answer = dcButton1 And strVendorID <> \"\" And strVendorName <> \"\" Then
            'The user clicked Save. Get the collection
            Set JE_Collection = DUOSObjectsGet(\"JE_Collection\")
            Set JE_Entry = JE_Collection.Item(JournalEntry)
            
            JE_Entry.Properties(\"VendorID\") = strVendorID
            JE_Entry.Properties(\"VendorName\") = strVendorName
        
        End If
    End If
    
    If PromptString = \"Are you sure you want to delete this transaction?\" Then
        If Answer = dcButton1 Then
            'The user clicked Delete on the delete dialog message
            WanttoDelete = True
        End If
    End If
End Sub

Private Sub Window_BeforeOpen(OpenVisible As Boolean)
    'Opening = True
    ' ADO Connection
    Set CN = UserInfoGet.CreateADOConnection
    'Use a client-side cursor so that a recordset count can be obtained later.
    CN.CursorLocation = 3
    'set the database to the currently logged in db
    CN.DefaultDatabase = UserInfoGet.IntercompanyID
    
    cmd.ActiveConnection = CN
    cmd.CommandType = adCmdText

        
End Sub

"
			EventMode	"1"
			Fields
			{
				WindowField	"(L) VendorID_Lookup"				
				{
					ArrayIndex	"0"
					DisplayName	"Lookup"
					Local	"true"
					ProgrammerName	"VendorID_Lookup"
				}
				WindowField	"(L) strVendorID"				
				{
					ArrayIndex	"0"
					DisplayName	"strVendorID"
					Local	"true"
					ProgrammerName	"strVendorID"
				}
				WindowField	"(L) strVendorName"				
				{
					ArrayIndex	"0"
					DisplayName	"strVendorName"
					Local	"true"
					ProgrammerName	"strVendorName"
				}
				WindowField	"Delete Button"				
				{
					ArrayIndex	"0"
					DisplayName	"Delete"
					Local	"false"
					ProgrammerName	"Delete Button"
				}
				WindowField	"Journal Entry"				
				{
					ArrayIndex	"0"
					DisplayName	"JournalEntry"
					Local	"false"
					ProgrammerName	"Journal Entry"
				}
				WindowField	"Post Button"				
				{
					ArrayIndex	"0"
					DisplayName	"Post"
					Local	"false"
					ProgrammerName	"Post Button"
				}
				WindowField	"Save Button"				
				{
					ArrayIndex	"0"
					DisplayName	"Save"
					Local	"false"
					ProgrammerName	"Save Button"
				}
				WindowField	"Source Document"				
				{
					ArrayIndex	"0"
					DisplayName	"SourceDocument"
					Local	"false"
					ProgrammerName	"Source Document"
				}
			}
			Title	"TransactionEntry"
		}
		Grid	"Transaction_Scroll"		
		{
			Code	""
			EventMode	"1"
			Fields
			{
			}
			Title	"TransactionEntryDetail"
		}
	}
}
</Component>
